version: v2
plugins:
  - local: ["go", "tool", "google.golang.org/protobuf/cmd/protoc-gen-go"]
    out: ./machinery/api
    opt:
      - paths=source_relative
  - local: ["go", "tool", "google.golang.org/grpc/cmd/protoc-gen-go-grpc"]
    out: ./machinery/api
    opt:
      - paths=source_relative
  - local: ["go", "tool", "github.com/planetscale/vtprotobuf/cmd/protoc-gen-go-vtproto"]
    out: ./machinery/api
    opt:
      - paths=source_relative
      - features=marshal+unmarshal+size
  - local: ["go", "tool", "github.com/pseudomuto/protoc-gen-doc/cmd/protoc-gen-doc"]
    strategy: all
    out: ./docs/
    opt:
      - docs.markdown.tmpl
      - api.md
inputs:
  - directory: .
    paths:
      - cluster/
      - common/
      - inspect/
      - machine/
      - resource/
      - security/
      - storage/
      - time/
